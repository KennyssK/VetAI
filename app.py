import streamlit as st
import pandas as pd
import numpy as np
import joblib
import tensorflow as tf
from tensorflow import keras
from pdf_generator import export_to_pdf

# --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –°–¢–†–ê–ù–ò–¶–´ ---
st.set_page_config(
    page_title="VetAI v0.4.1 (Alpha): –ü—Ä–æ—Ç–æ–∫–æ–ª –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏",
    page_icon="ü©∫",
    layout="wide",
    initial_sidebar_state="auto"
)

# –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.title('ü©∫ VetAI v0.4.1 (Alpha): –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏')
st.markdown('### –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö')
st.markdown('---')

# --- 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–†–ï–ê–õ–¨–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ v15) ---
MODEL_VERSION = 'v15 (150 –∫–ª–∞—Å—Å–æ–≤)'
MODEL_PATH = 'full_neural_network_model_v15_opt.h5'
PREPROCESSOR_PATH = 'full_preprocessor_v15.pkl'
ENCODER_PATH = 'full_label_encoder_v15.pkl'
FEATURES_PATH = 'full_feature_names_v15.pkl' 

@st.cache_resource
def load_artifacts():
    try:
        # –ú–æ–¥–µ–ª—å Keras
        model = keras.models.load_model(MODEL_PATH)
        # –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (StandardScaler)
        preprocessor = joblib.load(PREPROCESSOR_PATH)
        # –≠–Ω–∫–æ–¥–µ—Ä –º–µ—Ç–æ–∫
        label_encoder = joblib.load(ENCODER_PATH)
        # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è)
        training_features = joblib.load(FEATURES_PATH) 
        
        st.success(f"–ú–æ–¥–µ–ª—å **VetAI v{MODEL_VERSION}** ({len(training_features)} –ø—Ä–∏–∑–Ω–∞–∫–æ–≤) —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ.")
        return model, preprocessor, label_encoder, training_features
    except Exception as e:
        st.error(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏ v15: {e}. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∏.")
        
        # --- –ó–ê–ì–õ–£–®–ö–ò (–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è) ---
        class DummyModel:
            def predict(self, data):
                # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã –∫–ª—é—á–µ–π –¥–∏–∞–≥–Ω–æ–∑–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ —Å–ª–æ–≤–∞—Ä–µ-–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–µ
                return np.array([[0.65, 0.25, 0.10]]) 
        class DummyPreprocessor:
            def transform(self, data):
                return np.zeros((1, 3)) 
        class DummyEncoder:
            def inverse_transform(self, indices):
                # –ò–º–∏—Ç–∏—Ä—É–µ–º –≤—ã–≤–æ–¥ –∫–ª—é—á–µ–π –¥–∏–∞–≥–Ω–æ–∑–æ–≤
                classes = ['–≥–∞—Å—Ç—Ä–∏—Ç_—ç–æ–∑–∏–Ω–æ—Ñ–∏–ª—å–Ω—ã–π', '–ø–∏—Ä–æ–ø–ª–∞–∑–º–æ–∑_–æ—Å–ª–æ–∂–Ω–µ–Ω–Ω—ã–π', '–ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç_—Ç—è–∂–µ–ª—ã–π']
                return [classes[i] for i in indices]
        
        return DummyModel(), DummyPreprocessor(), DummyEncoder(), [] 

model, preprocessor, label_encoder, TRAINING_FEATURES = load_artifacts()

if not TRAINING_FEATURES and not isinstance(model, DummyModel):
    st.error("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã—Ä–æ–≤–Ω—è—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.")
    st.stop()


# --- –°–õ–û–í–ê–†–¨ –î–õ–Ø –ü–ï–†–ï–í–û–î–ê –î–ò–ê–ì–ù–û–ó–û–í (–ö–õ–Æ–ß–ò –ò–ó –ú–û–î–ï–õ–ò -> –†–£–°–°–ö–ò–ô + –õ–ê–¢–´–ù–¨) ---
# –í–ù–ò–ú–ê–ù–ò–ï: –î–û–ë–ê–í–¨–¢–ï –°–Æ–î–ê –í–°–ï 149 –î–ò–ê–ì–ù–û–ó–û–í –í –§–û–†–ú–ê–¢–ï '–∫–ª—é—á_–∏–∑_–º–æ–¥–µ–ª–∏': '–†—É—Å—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–õ–∞—Ç–∏–Ω—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)'
DIAGNOSIS_TRANSLATIONS = {
    '–≥–∞—Å—Ç—Ä–∏—Ç_—ç–æ–∑–∏–Ω–æ—Ñ–∏–ª—å–Ω—ã–π': '–≠–æ–∑–∏–Ω–æ—Ñ–∏–ª—å–Ω—ã–π –≥–∞—Å—Ç—Ä–∏—Ç (Gastritis eosinophilica)',
    '–ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç_—Ç—è–∂–µ–ª—ã–π': '–¢—è–∂–µ–ª—ã–π –ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç (Pancreatitis gravis)',
    '–ø–∏—Ä–æ–ø–ª–∞–∑–º–æ–∑_–æ—Å–ª–æ–∂–Ω–µ–Ω–Ω—ã–π': '–û—Å–ª–æ–∂–Ω–µ–Ω–Ω—ã–π –ø–∏—Ä–æ–ø–ª–∞–∑–º–æ–∑ (Piroplasmosis complicata)',
    '—ç–Ω—Ç–µ—Ä–∏—Ç_–ø–∞—Ä–≤–æ–≤–∏—Ä—É—Å–Ω—ã–π': '–ü–∞—Ä–≤–æ–≤–∏—Ä—É—Å–Ω—ã–π —ç–Ω—Ç–µ—Ä–∏—Ç (Enteritis parvovirosa)',
    '—Ö–æ–ª–µ—Ü–∏—Å—Ç–∏—Ç': '–•–æ–ª–µ—Ü–∏—Å—Ç–∏—Ç (Cholecystitis)',
    '–æ—Ç—Ä–∞–≤–ª–µ–Ω–∏–µ_–∞–Ω—Ç–∏—Ñ—Ä–∏–∑–æ–º': '–û—Ç—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω—Ç–∏—Ñ—Ä–∏–∑–æ–º (Intoxicatio antigelum)',
    '–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å_–ø–æ—á–µ—á–Ω–∞—è_–æ—Å—Ç—Ä–∞—è': '–û—Å—Ç—Ä–∞—è –ø–æ—á–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å (Insuff. renalis acuta)',
    '–∞–ª–ª–µ—Ä–≥–∏—á–µ—Å–∫–∏–π_–¥–µ—Ä–º–∞—Ç–∏—Ç_–ø–∏—â–µ–≤–æ–π': '–ü–∏—â–µ–≤–æ–π –∞–ª–ª–µ—Ä–≥–∏—á–µ—Å–∫–∏–π –¥–µ—Ä–º–∞—Ç–∏—Ç (Dermatitis allergica alimentaria)',
    # –î–û–ë–ê–í–¨–¢–ï –û–°–¢–ê–õ–¨–ù–´–ï –ö–õ–Æ–ß–ò –í–ê–®–ï–ô –ú–û–î–ï–õ–ò –°–Æ–î–ê
}


# --- 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (UI –∏ DataFrame) ---

# –î–ï–ú–û–ì–†–ê–§–ò–Ø (–ö–ª—é—á–∏ –¥–ª—è OHE)
demographic_keys = {
    '–ü–æ—Ä–æ–¥–∞': {'—Å–æ–±–∞–∫–∞': '–°–æ–±–∞–∫–∞', '–∫–æ—à–∫–∞': '–ö–æ—à–∫–∞'},
    '–í–æ–∑—Ä–∞—Å—Ç': {'–Ω–æ–≤–æ—Ä–æ–∂–¥–µ–Ω–Ω—ã–π': '–ù–æ–≤–æ—Ä–æ–∂–¥–µ–Ω–Ω—ã–π (–¥–æ 1 –º–µ—Å.)', '—â–µ–Ω–æ–∫_–∫–æ—Ç–µ–Ω–æ–∫': '–ú–æ–ª–æ–¥–Ω—è–∫', '–º–æ–ª–æ–¥–æ–π': '–ú–æ–ª–æ–¥–æ–π (1-5 –ª–µ—Ç)', '–≤–∑—Ä–æ—Å–ª—ã–π': '–í–∑—Ä–æ—Å–ª—ã–π (6-9 –ª–µ—Ç)', '—Å—Ç–∞—Ä—ã–π': '–°—Ç–∞—Ä—ã–π (10+ –ª–µ—Ç)'},
    '–ü–æ–ª': {'—Å–∞–º–µ—Ü': '–°–∞–º–µ—Ü', '—Å–∞–º–∫–∞': '–°–∞–º–∫–∞'},
    '–í–µ—Å': {'–Ω–∏–∑–∫–∏–π': '–ù–∏–∑–∫–∏–π, –∏—Å—Ç–æ—â–µ–Ω–∏–µ', '–Ω–æ—Ä–º–∞–ª—å–Ω—ã–π': '–ù–æ—Ä–º–∞–ª—å–Ω—ã–π', '–≤—ã—Å–æ–∫–∏–π': '–í—ã—Å–æ–∫–∏–π, –ª–∏—à–Ω–∏–π –≤–µ—Å', '–æ–∂–∏—Ä–µ–Ω–∏–µ_—Å–∏–ª—å–Ω–æ–µ': '–û–∂–∏—Ä–µ–Ω–∏–µ, —Å–∏–ª—å–Ω–æ–µ'},
    '–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞': {'–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è': '–ù–æ—Ä–º–∞–ª—å–Ω–∞—è', '–ø–æ–≤—ã—à–µ–Ω–Ω–∞—è': '–ü–æ–≤—ã—à–µ–Ω–Ω–∞—è', '–∫—Ä–∏—Ç–∏—á–Ω–æ_–ø–æ–≤—ã—à–µ–Ω–Ω–∞—è': '–ö—Ä–∏—Ç–∏—á–Ω–æ –ø–æ–≤—ã—à–µ–Ω–Ω–∞—è', '–≥–∏–ø–æ—Ç–µ—Ä–º–∏—è': '–ü–æ–Ω–∏–∂–µ–Ω–Ω–∞—è'},
    '–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ': {'–¥–æ–º–∞': '–î–æ–º–∞ (–∫–≤–∞—Ä—Ç–∏—Ä–Ω–æ–µ)', '—É–ª–∏—Ü–∞': '–ù–∞ —É–ª–∏—Ü–µ', '—á–∞—Å—Ç–Ω—ã–π_–¥–æ–º': '–ß–∞—Å—Ç–Ω—ã–π –¥–æ–º'},
    '–î–∏–µ—Ç–∞': {'–∫–æ—Ä–º': '–ì–æ—Ç–æ–≤—ã–π –∫–æ—Ä–º', '–Ω–∞—Ç—É—Ä–∞–ª–∫–∞': '–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è –ø–∏—â–∞'},
    # Vitals (–¥–ª—è OHE)
    '–û–±—â–µ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ': {'–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ': '–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ', '—Å—Ä–µ–¥–Ω–µ–π_—Ç—è–∂–µ—Å—Ç–∏': '–°—Ä–µ–¥–Ω–µ–π —Ç—è–∂–µ—Å—Ç–∏', '—Ç—è–∂–µ–ª–æ–µ': '–¢—è–∂–µ–ª–æ–µ', '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ': '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ'},
    '–ú–µ–Ω—Ç–∞–ª—å–Ω—ã–π_—Å—Ç–∞—Ç—É—Å': {'bar': 'BAR', 'qar': 'QAR', '–¥–µ–ø—Ä–µ—Å—Å–∏—è': '–î–µ–ø—Ä–µ—Å—Å–∏—è', '—Å—Ç—É–ø–æ—Ä': '–°—Ç—É–ø–æ—Ä', '–∫–æ–º–∞': '–ö–æ–º–∞'},
    '–ü—É–ª—å—Å': {'–Ω–æ—Ä–º–∞–ª—å–Ω—ã–π': '–ù–æ—Ä–º–∞–ª—å–Ω—ã–π', '—Ç–∞—Ö–∏–∫–∞—Ä–¥–∏—è': '–¢–∞—Ö–∏–∫–∞—Ä–¥–∏—è', '–±—Ä–∞–¥–∏–∫–∞—Ä–¥–∏—è': '–ë—Ä–∞–¥–∏–∫–∞—Ä–¥–∏—è', '–∞—Ä–∏—Ç–º–∏—è': '–ê—Ä–∏—Ç–º–∏—è', '—Å–ª–∞–±—ã–π': '–°–ª–∞–±—ã–π', '–Ω–∞–ø—Ä—è–∂–µ–Ω–Ω—ã–π': '–ù–∞–ø—Ä—è–∂–µ–Ω–Ω—ã–π'},
    '–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è_—Å–µ—Ä–¥—Ü–∞': {'—à—É–º–æ–≤_–Ω–µ—Ç': '–®—É–º–æ–≤ –Ω–µ—Ç', '—Å–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–∏–µ_—à—É–º—ã': '–°–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–∏–µ —à—É–º—ã', '–¥–∏–∞—Å—Ç–æ–ª–∏—á–µ—Å–∫–∏–µ_—à—É–º—ã': '–î–∏–∞—Å—Ç–æ–ª–∏—á–µ—Å–∫–∏–µ —à—É–º—ã', '–≥–ª—É—Ö–∏–µ_—Ç–æ–Ω—ã': '–ì–ª—É—Ö–∏–µ —Ç–æ–Ω—ã'},
    '–î—ã—Ö–∞–Ω–∏–µ_–ø–∞—Ç—Ç–µ—Ä–Ω': {'–Ω–æ—Ä–º–∞': '–ù–æ—Ä–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∏ –≥–ª—É–±–∏–Ω–∞', '—Ç–∞—Ö–∏–ø–Ω–æ—ç': '–¢–∞—Ö–∏–ø–Ω–æ—ç', '–±—Ä–∞–¥–∏–ø–Ω–æ—ç': '–ë—Ä–∞–¥–∏–ø–Ω–æ—ç', '–≥–∏–ø–µ—Ä–ø–Ω–æ—ç': '–ì–∏–ø–µ—Ä–ø–Ω–æ—ç', '—á–µ–π–Ω–∞_—Å—Ç–æ–∫—Å–∞': '–î—ã—Ö–∞–Ω–∏–µ –ß–µ–π–Ω–∞-–°—Ç–æ–∫—Å–∞', '–±–∏–æ—Ç–∞': '–î—ã—Ö–∞–Ω–∏–µ –ë–∏–æ—Ç–∞', '–∫—É—Å—Å–º–∞—É–ª—è': '–î—ã—Ö–∞–Ω–∏–µ –ö—É—Å—Å–º–∞—É–ª—è', '–≥—Ä–æ–∫–∫–æ': '–î—ã—Ö–∞–Ω–∏–µ –ì—Ä–æ–∫–∫–æ', '—á–µ—Ä–Ω–∏': '–î—ã—Ö–∞–Ω–∏–µ –ß–µ—Ä–Ω–∏', '–¥–∏—Å–ø–Ω–æ—ç': '–î–∏—Å–ø–Ω–æ—ç', '–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ': '–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ', '–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏_—Ä–µ–¥–∫–æ–µ': '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–¥–∫–æ–µ'},
    '–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è_–ª–µ–≥–∫–∏—Ö': {'–≤–µ–∑–∏–∫—É–ª—è—Ä–Ω–æ–µ': '–í–µ–∑–∏–∫—É–ª—è—Ä–Ω–æ–µ (–ù–æ—Ä–º–∞)', '—Ö—Ä–∏–ø—ã_—Å—É—Ö–∏–µ': '–•—Ä–∏–ø—ã —Å—É—Ö–∏–µ', '—Ö—Ä–∏–ø—ã_–≤–ª–∞–∂–Ω—ã–µ': '–•—Ä–∏–ø—ã –≤–ª–∞–∂–Ω—ã–µ', '–±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–æ–µ': '–ë—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–æ–µ', '–∫—Ä–µ–ø–∏—Ç–∞—Ü–∏—è': '–ö—Ä–µ–ø–∏—Ç–∞—Ü–∏—è', '–∂–µ—Å—Ç–∫–æ–µ_–±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–æ–µ': '–ñ–µ—Å—Ç–∫–æ–µ –±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–æ–µ', '–æ—Å–ª–∞–±–ª–µ–Ω–Ω–æ–µ': '–û—Å–ª–∞–±–ª–µ–Ω–Ω–æ–µ'},
    '–¢–∏–ø_–¥—ã—Ö–∞–Ω–∏—è': {'–≥—Ä—É–¥–æ_–±—Ä—é—à–Ω–æ–µ': '–ì—Ä—É–¥–æ-–±—Ä—é—à–Ω–æ–µ', '–±—Ä—é—à–Ω–æ–µ': '–ë—Ä—é—à–Ω–æ–µ', '—Å–º–µ—à–∞–Ω–Ω–æ–µ': '–°–º–µ—à–∞–Ω–Ω–æ–µ (–ù–æ—Ä–º–∞)'},
    '–î–µ–≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è': {'–Ω–µ—Ç': '–ù–µ—Ç', '1_—Å—Ç–∞–¥–∏—è': '1 —Å—Ç–∞–¥–∏—è (–¥–æ 5%)', '2_—Å—Ç–∞–¥–∏—è': '2 —Å—Ç–∞–¥–∏—è (5-6%)', '3_—Å—Ç–∞–¥–∏—è': '3 —Å—Ç–∞–¥–∏—è (7-8%)', '—Ç—è–∂–µ–ª—ã–π_—à–æ–∫': '–¢—è–∂–µ–ª—ã–π —à–æ–∫ (8+%)'},
    '–ö–ù–°': {'–Ω–æ—Ä–º–∞': '–ù–æ—Ä–º–∞ (1-2 —Å–µ–∫)', '–∑–∞–º–µ–¥–ª–µ–Ω–Ω–æ–µ': '–ó–∞–º–µ–¥–ª–µ–Ω–Ω–æ–µ (–ö–ù–° > 3 —Å–µ–∫)', '—É—Å–∫–æ—Ä–µ–Ω–Ω–æ–µ': '–£—Å–∫–æ—Ä–µ–Ω–Ω–æ–µ (–ö–ù–° < 1 —Å–µ–∫)'},
    '–¢–æ–Ω–æ–º–µ—Ç—Ä–∏—è': {'–Ω–µ_–ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å': '–ù–µ –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å', '–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ': '–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ', '–ø–æ–≤—ã—à–µ–Ω–Ω–æ–µ': '–ü–æ–≤—ã—à–µ–Ω–Ω–æ–µ', '–ø–æ–Ω–∏–∂–µ–Ω–Ω–æ–µ': '–ü–æ–Ω–∏–∂–µ–Ω–Ω–æ–µ'}
}

# –í–ê–ö–¶–ò–ù–´ (–ö–ª—é—á–∏ –¥–ª—è OHE)
VACCINES_DOGS_VIRUS = {'–ù–µ—Ç_–≤–∏—Ä—É—Å–Ω–æ–π_–≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏': '–ù–µ—Ç', 'biocan_dhppi': '–ë–∏–æ–∫–∞–Ω DHPPI', 'multican_8': '–ú—É–ª—å—Ç–∏–∫–∞–Ω-8', 'multican_4_6': '–ú—É–ª—å—Ç–∏–∫–∞–Ω-4/6', 'eurican': '–≠—É—Ä–∏–∫–∞–Ω', 'asterion': '–ê—Å—Ç–µ—Ä–∏–æ–Ω', 'hexacanivac': '–ì–µ–∫—Å–∞–∫–∞–Ω–∏–≤–∞–∫', 'nobivac_dhppi': '–ù–æ–±–∏–≤–∞–∫ DHPPI', 'nobivac_l4': '–ù–æ–±–∏–≤–∞–∫ L4',}
VACCINES_DOGS_RABIES = {'–ù–µ—Ç_–±–µ—à–µ–Ω—Å—Ç–≤–∞': '–ù–µ—Ç', 'rabisin_d': '–†–∞–±–∏–∑–∏–Ω', 'rabikan': '–†–∞–±–∏–∫–∞–Ω', 'nobivac_rabies': '–ù–æ–±–∏–≤–∞–∫ Rabies', 'defensor': '–î–µ—Ñ–µ–Ω—Å–æ—Ä', 'nobivac_rl': '–ù–æ–±–∏–≤–∞–∫ RL'} 
DOG_COMPLEX_RABIES = {'–ú—É–ª—å—Ç–∏–∫–∞–Ω-8': '–ú—É–ª—å—Ç–∏–∫–∞–Ω-8 (–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è)', '–ù–æ–±–∏–≤–∞–∫ RL': '–ù–æ–±–∏–≤–∞–∫ RL (–ë–µ—à–µ–Ω—Å—Ç–≤–æ + –õ–µ–ø—Ç–æ—Å–ø–∏—Ä–æ–∑)'}

VACCINES_CATS_VIRUS = {'–ù–µ—Ç_–≤–∏—Ä—É—Å–Ω–æ–π_–≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏': '–ù–µ—Ç', 'multifel_4': '–ú—É–ª—å—Ç–∏—Ñ–µ–ª 4', 'purevax_3': '–ü—É—Ä–µ–≤–∞–∫—Å RCP', 'purevax_4': '–ü—É—Ä–µ–≤–∞–∫—Å RCPCh', 'purevax_felv': '–ü—É—Ä–µ–≤–∞–∫—Å FeLV', 'nobivac_triket': '–ù–æ–±–∏–≤–∞–∫ –¢—Ä–∏–∫–µ—Ç', 'biofel_pch': '–ë–∏–æ—Ñ–µ–ª PCH', 'leucogen': '–õ–µ–π–∫–æ–≥–µ–Ω',}
VACCINES_CATS_RABIES = {'–ù–µ—Ç_–±–µ—à–µ–Ω—Å—Ç–≤–∞': '–ù–µ—Ç', 'rabifel': '–†–∞–±–∏—Ñ–µ–ª', 'rabisin_c': '–†–∞–±–∏–∑–∏–Ω', 'nobivac_rabies': '–ù–æ–±–∏–≤–∞–∫ Rabies', 'defensor': '–î–µ—Ñ–µ–Ω—Å–æ—Ä', 'biofel_pchr': '–ë–∏–æ—Ñ–µ–ª PCHR', 'quadricat': '–ö–≤–∞–¥—Ä–∏–∫–∞—Ç'}
CAT_COMPLEX_RABIES = {'–ú—É–ª—å—Ç–∏—Ñ–µ–ª 4': '–ú—É–ª—å—Ç–∏—Ñ–µ–ª 4 (–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è)', '–ë–∏–æ—Ñ–µ–ª PCHR': '–ë–∏–æ—Ñ–µ–ª PCHR (–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è)', '–ö–≤–∞–¥—Ä–∏–∫–∞—Ç': '–ö–≤–∞–¥—Ä–∏–∫–∞—Ç (–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è)'}


# --- –ö–õ–ò–ù–ò–ß–ï–°–ö–ò–ï –°–ò–ú–ü–¢–û–ú–´ (–ë–∏–Ω–∞—Ä–Ω—ã–µ –∫–ª—é—á–∏) ---
symptom_groups = {
    "–û–±—â–∏–µ, –°–∏—Å—Ç–µ–º–Ω—ã–µ": [
        ('–ì–∏–ø–æ–¥–∏–Ω–∞–º–∏—è', '–ì–∏–ø–æ–¥–∏–Ω–∞–º–∏—è (—Å–Ω–∏–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)'), ('–õ–µ—Ç–∞—Ä–≥–∏—è', '–õ–µ—Ç–∞—Ä–≥–∏—è (—Å—Ç—É–ø–æ—Ä)'), 
        ('–ê–Ω–æ—Ä–µ–∫—Å–∏—è', '–ê–Ω–æ—Ä–µ–∫—Å–∏—è (–ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞–∑ –æ—Ç –µ–¥—ã)'), ('–ì–∏–ø–æ—Ä–µ–∫—Å–∏—è', '–ì–∏–ø–æ—Ä–µ–∫—Å–∏—è (–°–Ω–∏–∂–µ–Ω–∏–µ –∞–ø–ø–µ—Ç–∏—Ç–∞)'),
        ('–ò–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω—ã–π_–∞–ø–ø–µ—Ç–∏—Ç', '–ò–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω—ã–π –∞–ø–ø–µ—Ç–∏—Ç'), ('–ü–∏–∫–æ—Ü–∏–∑–º', '–ü–∏–∫–æ—Ü–∏–∑–º'), 
        ('–¢–æ—à–Ω–æ—Ç–∞', '–¢–æ—à–Ω–æ—Ç–∞'), ('–ë–æ—Ä–±–æ—Ä–∏–≥–º—ã', '–ë–æ—Ä–±–æ—Ä–∏–≥–º—ã'),
        ('–ü–æ—Ç–µ—Ä—è_–≤–µ—Å–∞', '–ó–∞–º–µ—Ç–Ω–æ–µ –ø–æ—Ö—É–¥–µ–Ω–∏–µ'), ('–î—Ä–æ–∂—å_—Ç–µ–ª–∞', '–î—Ä–æ–∂—å, —Ç—Ä–µ–º–æ—Ä —Ç–µ–ª–∞'),
        ('–®–æ–∫_—Å–ª–∞–±–æ—Å—Ç—å', '–°–æ—Å—Ç–æ—è–Ω–∏–µ —à–æ–∫–∞'), ('–ù–µ_–¥–∞–µ—Ç_–ø—Ä–∏–∫–æ—Å–Ω—É—Ç—å—Å—è', '–ë–æ–ª—å, –Ω–µ –¥–∞–µ—Ç –∫ —Å–µ–±–µ –ø—Ä–∏–∫–æ—Å–Ω—É—Ç—å—Å—è'),
        ('–í–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è', '–ù–µ–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è –≤–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è'), ('–ê–≥—Ä–µ—Å—Å–∏—è', '–ê–≥—Ä–µ—Å—Å–∏—è'),
        ('–ü—Ä—è—á–µ—Ç—Å—è_–∏–∑–æ–ª–∏—Ä—É–µ—Ç—Å—è', '–ü—Ä—è—á–µ—Ç—Å—è, –∏–∑–æ–ª–∏—Ä—É–µ—Ç—Å—è'), ('–ë–µ–∑_—Å–æ–∑–Ω–∞–Ω–∏—è', '–ü–æ—Ç–µ—Ä—è —Å–æ–∑–Ω–∞–Ω–∏—è')
    ],
    "–ü–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ (–ñ–ö–¢, –†–æ—Ç)": [
        ('–î–∏—Å—Ñ–∞–≥–∏—è', '–î–∏—Å—Ñ–∞–≥–∏—è'), ('–†–µ–≥—É—Ä–≥–∏—Ç–∞—Ü–∏—è', '–†–µ–≥—É—Ä–≥–∏—Ç–∞—Ü–∏—è'),
        ('–†–≤–æ—Ç–∞_—Ç–∞—â–µ–∫–æ–≤–∞—è', '–†–≤–æ—Ç–∞ —Ç–∞—â–µ–∫–æ–≤–∞—è'), ('–†–≤–æ—Ç–∞_–ø–æ—Å—Ç–±—Ä–∞–Ω–¥–∏–∞–ª—å–Ω–∞—è_—Ä–∞–Ω–æ', '–†–≤–æ—Ç–∞ –ø–æ—Å—Ç–±—Ä–∞–Ω–¥–∏–∞–ª—å–Ω–∞—è (–¥–æ 30 –º–∏–Ω)'),
        ('–†–≤–æ—Ç–∞_–ø–æ—Å—Ç–±—Ä–∞–Ω–¥–∏–∞–ª—å–Ω–∞—è_–ø–æ–∑–¥–Ω–æ', '–†–≤–æ—Ç–∞ –ø–æ—Å—Ç–±—Ä–∞–Ω–¥–∏–∞–ª—å–Ω–∞—è (1-2 —á–∞—Å–∞)'), ('–†–≤–æ—Ç–∞_—Å–º–µ—à–∞–Ω–Ω–∞—è', '–†–≤–æ—Ç–∞ —Å–º–µ—à–∞–Ω–Ω–∞—è'),
        ('–ü–æ–ª–∏–¥–∏–ø—Å–∏—è', '–ü–æ–ª–∏–¥–∏–ø—Å–∏—è'), ('–û–ª–∏–≥–æ–¥–∏–ø—Å–∏—è', '–û–ª–∏–≥–æ–¥–∏–ø—Å–∏—è'), ('–ê–¥–∏–ø—Å–∏—è', '–ê–¥–∏–ø—Å–∏—è'),
        ('–¢–æ–ª—Å—Ç–æ–∫–∏—à–µ—á–Ω–∞—è_–¥–∏–∞—Ä–µ—è', '–î–∏–∞—Ä–µ—è (–¢–æ–ª—Å—Ç–æ–∫–∏—à–µ—á–Ω–∞—è)'), ('–¢–æ–Ω–∫–æ–∫–∏—à–µ—á–Ω–∞—è_–¥–∏–∞—Ä–µ—è', '–î–∏–∞—Ä–µ—è (–¢–æ–Ω–∫–æ–∫–∏—à–µ—á–Ω–∞—è)'), ('–°–º–µ—à–∞–Ω–Ω–∞—è_–¥–∏–∞—Ä–µ—è', '–î–∏–∞—Ä–µ—è (–°–º–µ—à–∞–Ω–Ω–∞—è)'), 
        ('–ó–∞–ø–æ—Ä', '–ó–∞–ø–æ—Ä'), ('–°–ª–µ–¥—ã_–∫—Ä–æ–≤–∏_–∞–ª–∞—è', '–ö—Ä–æ–≤—å –≤ —Å—Ç—É–ª–µ (–∞–ª–∞—è)'), ('–°–ª–µ–¥—ã_–∫—Ä–æ–≤–∏_—Å–ø–µ–∫—à–∞—è—Å—è', '–ö—Ä–æ–≤—å –≤ —Å—Ç—É–ª–µ (—Å–ø–µ–∫—à–∞—è—Å—è)'),
        ('–°—Ç–µ–∞—Ç–æ–∞—Ä–µ—è', '–°—Ç–µ–∞—Ç–æ–∞—Ä–µ—è (—Å–ª–∏–∑—å –≤ –∫–∞–ª–µ)'), ('–ö–∞–ª_–±–µ–ª—ã–π_–∂–µ–ª—Ç—ã–π', '–ö–∞–ª –Ω–µ–æ–±—ã—á–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ (–±–µ–ª—ã–π/–∂–µ–ª—Ç—ã–π)'), ('–ú–µ–ª–µ–Ω–∞', '–ú–µ–ª–µ–Ω–∞ (—á–µ—Ä–Ω—ã–π –∫–∞–ª)'),
        ('–Ø–π—Ü–∞_–≥–ª–∏—Å—Ç–æ–≤_–≤_–∫–∞–ª–µ', '–í–∏–¥–∏–º—ã–µ —è–π—Ü–∞ –≥–ª–∏—Å—Ç–æ–≤'),
        ('–ñ–∏–≤–æ—Ç_—É–≤–µ–ª–∏—á–µ–Ω', '–ñ–∏–≤–æ—Ç —É–≤–µ–ª–∏—á–µ–Ω'), ('–ñ–∏–≤–æ—Ç_–±–æ–ª–µ–∑–Ω–µ–Ω', '–ñ–∏–≤–æ—Ç –±–æ–ª–µ–∑–Ω–µ–Ω–Ω—ã–π'), ('–ñ–∏–≤–æ—Ç_–Ω–∞–ø—Ä—è–∂–µ–Ω', '–ñ–∏–≤–æ—Ç –Ω–∞–ø—Ä—è–∂–µ–Ω'),
        ('–ù–µ–ø—Ä–∏—è—Ç–Ω—ã–π_–∑–∞–ø–∞—Ö_–∏–∑–æ_—Ä—Ç–∞', '–ù–µ–ø—Ä–∏—è—Ç–Ω—ã–π –∑–∞–ø–∞—Ö –∏–∑–æ —Ä—Ç–∞'), ('–ó—É–±–Ω–æ–π_–∫–∞–º–µ–Ω—å', '–û–±–∏–ª—å–Ω—ã–π –∑—É–±–Ω–æ–π –∫–∞–º–µ–Ω—å'), 
        ('–ì–µ–Ω–≥–∏–≤–∏—Ç_—ç—Ä–æ–∑–∏–∏_—è–∑–≤—ã', '–ì–µ–Ω–≥–∏–≤–∏—Ç/–°—Ç–æ–º–∞—Ç–∏—Ç, –≠—Ä–æ–∑–∏–∏/–Ø–∑–≤—ã'), ('–ì–∏–ø–µ—Ä—Å–∞–ª–∏–≤–∞—Ü–∏—è', '–ì–∏–ø–µ—Ä—Å–∞–ª–∏–≤–∞—Ü–∏—è'),
        ('–ü—Ç–µ–æ–ª–∏–∑–º', '–ü—Ç–∏–∞–ª–∏–∑–º'), ('–ü–∞—Ç–æ–ª–æ–≥–∏–∏_—á–µ–ª—é—Å—Ç–∏_–∑—É–±–æ–≤', '–ü–∞—Ç–æ–ª–æ–≥–∏–∏ –∑—É–±–æ–≤/—á–µ–ª—é—Å—Ç–∏')
    ],
    "–õ–∏–º—Ñ–æ—É–∑–ª—ã –∏ –ü–∞–ª—å–ø–∞—Ü–∏—è": [
        ('–£–≤–µ–ª–∏—á–µ–Ω–∏–µ_–Ω–∏–∂–Ω–µ—á–µ–ª—é—Å—Ç–Ω—ã—Ö_–õ–£', '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∏–∂–Ω–µ—á–µ–ª—é—Å—Ç–Ω—ã—Ö –õ–£'), ('–£–≤–µ–ª–∏—á–µ–Ω–∏–µ_–ø–æ–¥–º—ã—à–µ—á–Ω—ã—Ö_–õ–£', '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–¥–º—ã—à–µ—á–Ω—ã—Ö –õ–£'), 
        ('–£–≤–µ–ª–∏—á–µ–Ω–∏–µ_–ø–∞—Ö–æ–≤—ã—Ö_–õ–£', '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–∞—Ö–æ–≤—ã—Ö –õ–£'), ('–£–≤–µ–ª–∏—á–µ–Ω–∏–µ_–ø–æ–¥–∫–æ–ª–µ–Ω–Ω—ã—Ö_–õ–£', '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–¥–∫–æ–ª–µ–Ω–Ω—ã—Ö –õ–£'), 
        ('–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ_–ø–æ—á–∫–∏', '–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ –ø–æ—á–∫–∏'), ('–ù–µ—Ä–æ–≤–Ω—ã–µ_–∫–æ–Ω—Ç—É—Ä—ã_–ø–æ—á–µ–∫', '–ù–µ—Ä–æ–≤–Ω—ã–µ –∫–æ–Ω—Ç—É—Ä—ã –ø–æ—á–µ–∫'),
        ('–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞_–¥–∏–ª–∞—Ç–∞—Ü–∏—è', '–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –¥–∏–ª–∞—Ç–∞—Ü–∏—è'),
        ('–ë–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ—Å—Ç—å_–º–æ—á–µ–≤–æ–≥–æ_–ø—É–∑—ã—Ä—è', '–ú–æ—á–µ–≤–æ–π –ø—É–∑—ã—Ä—å –±–æ–ª–µ–∑–Ω–µ–Ω/–Ω–∞–ø—Ä—è–∂–µ–Ω'), ('–ü–∞—Ç–æ–ª–æ–≥–∏—è_—Ä–µ–∫—Ç–∞–ª—å–Ω–æ–≥–æ_–æ—Å–º–æ—Ç—Ä–∞', '–ü–∞—Ç–æ–ª–æ–≥–∏—è –ø—Ä–∏ —Ä–µ–∫—Ç–∞–ª—å–Ω–æ–º –æ—Å–º–æ—Ç—Ä–µ')
    ],
    "–î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞": [
        ('–ö–∞—à–µ–ª—å_—Å—É—Ö–æ–π', '–ö–∞—à–µ–ª—å (—Å—É—Ö–æ–π)'), ('–ö–∞—à–µ–ª—å_–≤–ª–∞–∂–Ω—ã–π', '–ö–∞—à–µ–ª—å (–≤–ª–∞–∂–Ω—ã–π)'), ('–ß–∏—Ö–∞–Ω–∏–µ', '–ß–∞—Å—Ç–æ–µ —á–∏—Ö–∞–Ω–∏–µ'), 
        ('–†–∏–Ω–æ—Ä–µ—è_–ø—Ä–æ—Å—Ç–∞—è', '–†–∏–Ω–æ—Ä–µ—è (–ø—Ä–æ—Å—Ç–∞—è)'), ('–†–∏–Ω–æ—Ä–µ—è_–≥–Ω–æ–π–Ω–æ_–∫–∞—Ç–∞—Ä–∞–ª—å–Ω–∞—è', '–†–∏–Ω–æ—Ä–µ—è (–≥–Ω–æ–π–Ω–æ-–∫–∞—Ç–∞—Ä–∞–ª—å–Ω–∞—è)'), 
        ('–°–≤–∏—Å—Ç_–ø—Ä–∏_–¥—ã—Ö–∞–Ω–∏–∏', '–°–≤–∏—Å—Ç, —Ö—Ä–∏–ø—ã –ø—Ä–∏ –¥—ã—Ö–∞–Ω–∏–∏'), 
        ('–¢–µ—Å—Ç_—Ö–æ–ª–æ–¥–Ω–æ–≥–æ_—Å—Ç–µ–∫–ª–∞_–æ—Ç—Ä–∏—Ü_–æ–¥–Ω–æ', '–¢–µ—Å—Ç —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–µ–∫–ª–∞ (-) –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π'),
        ('–¢–µ—Å—Ç_—Ö–æ–ª–æ–¥–Ω–æ–≥–æ_—Å—Ç–µ–∫–ª–∞_–æ—Ç—Ä–∏—Ü_–¥–≤—É', '–¢–µ—Å—Ç —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–µ–∫–ª–∞ (-) –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π'),
        ('–£–≤–µ–ª–∏—á–µ–Ω–∏–µ_–Ω–æ—Å–æ–≤—ã—Ö_—Ö–æ–¥–æ–≤', '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–æ—Å–æ–≤—ã—Ö —Ö–æ–¥–æ–≤'),
    ],
    "–ú–æ—á–µ–ø–æ–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞": [
        ('–ü–æ–ª–Ω—É—é—Ä–∏—è', '–ü–æ–ª–Ω—É—é—Ä–∏—è'),
        ('–ü–æ–ª–ª–∞–∫–∏—É—Ä–∏—è', '–ü–æ–ª–ª–∞–∫–∏—É—Ä–∏—è'), 
        ('–û–ª–∏–≥—É—Ä–∏—è', '–û–ª–∏–≥—É—Ä–∏—è'), 
        ('–ê–Ω—É—Ä–∏—è', '–ê–Ω—É—Ä–∏—è'), 
        ('–î–∏–∑—É—Ä–∏—è_—Å—Ç—Ä–∞–Ω–≥—É—Ä–∏—è', '–î–∏–∑—É—Ä–∏—è/–°—Ç—Ä–∞–Ω–≥—É—Ä–∏—è'), 
        ('–ò—à—É—Ä–∏—è', '–ò—à—É—Ä–∏—è'),
        ('–ü–µ—Ä–∏—É—Ä–∏—è', '–ü–µ—Ä–∏—É—Ä–∏—è'),
        ('–ù–µ–¥–µ—Ä–∂–∞–Ω–∏–µ_–º–æ—á–∏', '–ù–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ'), 
        ('–ì–µ–º–∞—Ç—É—Ä–∏—è', '–ì–µ–º–∞—Ç—É—Ä–∏—è'), 
        ('–ò–∑–º–µ–Ω–µ–Ω–∏–µ_–∑–∞–ø–∞—Ö–∞_–º–æ—á–∏', '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–ø–∞—Ö–∞ –º–æ—á–∏'), ('–ú–æ—á–∞_–Ω–µ–æ–±—ã—á–Ω–æ–≥–æ_—Ü–≤–µ—Ç–∞', '–ú–æ—á–∞ –Ω–µ–æ–±—ã—á–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞'),
        ('–í—ã–¥–µ–ª–µ–Ω–∏—è_–∏–∑_–ø–µ–Ω–∏—Å–∞', '–í—ã–¥–µ–ª–µ–Ω–∏—è –∏–∑ –ø—Ä–µ–ø—É—Ü–∏—è/–ø–µ–Ω–∏—Å–∞'), ('–í—ã–¥–µ–ª–µ–Ω–∏—è_–∏–∑_–ø–µ—Ç–ª–∏', '–í—ã–¥–µ–ª–µ–Ω–∏—è –∏–∑ –ø–µ—Ç–ª–∏/–≤–ª–∞–≥–∞–ª–∏—â–∞'), 
        ('–ì–∏–ø–µ—Ä–µ–º–∏—è_–ø–µ–Ω–∏—Å–∞', '–ì–∏–ø–µ—Ä–µ–º–∏—è –ø–µ–Ω–∏—Å–∞'), ('–ê–≥–µ–Ω–∏–∑–∏—è', '–ê–≥–µ–Ω–∏–∑–∏—è'),
        ('–í–æ—Å–ø–∞–ª–µ–Ω–∏–µ_–º–æ–ª–æ—á–Ω—ã—Ö_–∂–µ–ª–µ–∑', '–í–æ—Å–ø–∞–ª–µ–Ω–∏–µ –º–æ–ª–æ—á–Ω—ã—Ö –∂–µ–ª–µ–∑'),
    ],
    "–ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞": [
        ('–ê—Ç–æ–∫—Å–∏—è', '–ê—Ç–æ–∫—Å–∏—è'),
        ('–°—É–¥–æ—Ä–æ–≥–∏_–∫–ª–æ–Ω–∏—á–µ—Å–∫–∏–µ', '–°—É–¥–æ—Ä–æ–≥–∏ (–∫–ª–æ–Ω–∏—á–µ—Å–∫–∏–µ)'), ('–°—É–¥–æ—Ä–æ–≥–∏_—Ç–æ–Ω–∏—á–µ—Å–∫–∏–µ', '–°—É–¥–æ—Ä–æ–≥–∏ (—Ç–æ–Ω–∏—á–µ—Å–∫–∏–µ)'), ('–°—É–¥–æ—Ä–æ–≥–∏_–∫–ª–æ–Ω–∏–∫–æ—Ç–æ–Ω–∏—á–µ—Å–∫–∏–µ', '–°—É–¥–æ—Ä–æ–≥–∏ (–∫–ª–æ–Ω–∏–∫–æ—Ç–æ–Ω–∏—á–µ—Å–∫–∏–µ)'),
        ('–î–∏—Å–∫–µ–Ω–∏–∑–∏—è', '–î–∏—Å–∫–µ–Ω–∏–∑–∏—è'), ('–ú–æ–∑–∂–µ—á–∫–æ–≤–∞—è_–ø–∞—Ç–æ–ª–æ–≥–∏—è', '–ú–æ–∑–∂–µ—á–∫–æ–≤–∞—è –ø–∞—Ç–æ–ª–æ–≥–∏—è'), 
        ('–í–µ—Å—Ç–∏–±—É–ª—è—Ä–Ω–∞—è_–ø–∞—Ç–æ–ª–æ–≥–∏—è', '–í–µ—Å—Ç–∏–±—É–ª—è—Ä–Ω–∞—è –ø–∞—Ç–æ–ª–æ–≥–∏—è'), ('–ü—Ä–æ–ø—Ä–∏–æ—Ü–µ–ø—Ç–∏–≤–Ω–∞—è_–ø–∞—Ç–æ–ª–æ–≥–∏—è', '–ü—Ä–æ–ø—Ä–∏–æ—Ü–µ–ø—Ç–∏–≤–Ω–∞—è –ø–∞—Ç–æ–ª–æ–≥–∏—è'),
        ('–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ_–ì–ë–ß', '–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ì–ë–ß'), ('–°–Ω–∏–∂–µ–Ω–Ω–∞—è_–ø—Ä–æ–ø—Ä–∏–æ—Ü–µ–ø—Ü–∏—è', '–°–Ω–∏–∂–µ–Ω–Ω–∞—è –ø—Ä–æ–ø—Ä–∏–æ—Ü–µ–ø—Ü–∏—è'),
        ('–ê–ª–ª–æ–¥–∏–Ω–∏—è', '–ê–ª–ª–æ–¥–∏–Ω–∏—è'), ('–•—Ä–æ–º–æ—Ç–∞', '–•—Ä–æ–º–æ—Ç–∞/–±–æ–ª—å –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏'), 
    ],
    "–ö–æ–∂–∞, –®–µ—Ä—Å—Ç—å": [
        ('–ó—É–¥_—á–µ—à–µ—Ç—Å—è', '–°–∏–ª—å–Ω—ã–π –∑—É–¥'), ('–ê–ª–æ–ø–µ—Ü–∏—è', '–ê–ª–æ–ø–µ—Ü–∏—è'), ('–õ–µ—Ö–∏–Ω–µ—Ñ–∏–∫–∞—Ü–∏—è', '–õ–∏—Ö–µ–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è'), 
        ('–ü–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ_–∫–æ–∂–∏', '–ü–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ'), ('–°—ã–ø—å_–ø—É–∑—ã—Ä—å–∫–∏', '–°—ã–ø—å, –≤–æ–¥—è–Ω–∏—Å—Ç—ã–µ –ø—É–∑—ã—Ä—å–∫–∏'), 
        ('–ü–µ—Ä—Ö–æ—Ç—å_—à–µ–ª—É—à–µ–Ω–∏–µ', '–ü–µ—Ä—Ö–æ—Ç—å, —à–µ–ª—É—à–µ–Ω–∏–µ'), ('–†–∞–Ω–∫–∏_–Ω–∞_–∫–æ–∂–µ', '–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞–Ω–∫–∏'), 
        ('–£–ø–ª–æ—Ç–Ω–µ–Ω–∏—è_—à–∏—à–∫–∏', '–£–ø–ª–æ—Ç–Ω–µ–Ω–∏—è, —à–∏—à–∫–∏'), ('–ö–∞—Ç–∞–Ω–∏–µ_–Ω–∞_–ø–æ–ø–µ', '–ö–∞—Ç–∞–Ω–∏–µ –Ω–∞ –ø–æ–ø–µ'), 
        ('–ò–∑–º–µ–Ω–µ–Ω–∏–µ_—Ü–≤–µ—Ç–∞_—à–µ—Ä—Å—Ç–∏', '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ —à–µ—Ä—Å—Ç–∏'), ('–õ–∞–º–ø–∞—Å_–Ω–∞_—Å–ø–∏–Ω–µ_—É_–∫–æ—à–µ–∫', '–õ–∞–º–ø–∞—Å –Ω–∞ —Å–ø–∏–Ω–µ'),
        ('–í—ã–ø–∞–¥–µ–Ω–∏–µ_—à–µ—Ä—Å—Ç–∏', '–í—ã–ø–∞–¥–µ–Ω–∏–µ —à–µ—Ä—Å—Ç–∏')
    ],
    "–ì–ª–∞–∑–∞, –£—à–∏, –ù–æ—Å": [
        ('–≠–ø–∏—Ñ–æ—Ä–∞_–≥–Ω–æ–π–Ω–∞—è', '–≠–ø–∏—Ñ–æ—Ä–∞ (–≥–Ω–æ–π–Ω–∞—è)'), ('–≠–ø–∏—Ñ–æ—Ä–∞_–≥–Ω–æ–π–Ω–æ_–∫–∞—Ç–∞—Ä–∞–ª—å–Ω–∞—è', '–≠–ø–∏—Ñ–æ—Ä–∞ (–≥–Ω–æ–π–Ω–æ-–∫–∞—Ç–∞—Ä–∞–ª—å–Ω–∞—è)'), ('–≠–ø–∏—Ñ–æ—Ä–∞_–ø—Ä–æ—Å—Ç–∞—è', '–≠–ø–∏—Ñ–æ—Ä–∞ (–ø—Ä–æ—Å—Ç–∞—è)'),
        ('–≠–ø–∏—Ñ–æ—Ä–∞_–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è', '–≠–ø–∏—Ñ–æ—Ä–∞ (–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ)'), ('–û–Ω–∏–∑–æ–∫–∞—Ä–∏—è', '–û–Ω–∏–∑–æ–∫–∞—Ä–∏—è'), 
        ('–≠–Ω–æ—Ñ—Ç–∞–ª—å–º', '–≠–Ω–æ—Ñ—Ç–∞–ª—å–º'), ('–≠–∫–∑–æ—Ñ—Ç–∞–ª—å–º', '–≠–∫–∑–æ—Ñ—Ç–∞–ª—å–º'), 
        ('–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ_—Ä–µ–∞–∫—Ü–∏–∏_–Ω–∞_—Å–≤–µ—Ç', '–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–≤–µ—Ç'), ('–í—ã–ø–∞–¥–µ–Ω–∏–µ_—Ç—Ä–µ—Ç—å–µ–≥–æ_–≤–µ–∫–∞_–¥–≤—É', '–í—ã–ø–∞–¥–µ–Ω–∏–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –≤–µ–∫–∞ (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ)'), 
        ('–í—ã–ø–∞–¥–µ–Ω–∏–µ_—Ç—Ä–µ—Ç—å–µ–≥–æ_–≤–µ–∫–∞_–æ–¥–Ω–æ', '–í—ã–ø–∞–¥–µ–Ω–∏–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –≤–µ–∫–∞ (–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ)'), ('–°—Ç—Ä–æ–±–∏–∑–º_–¥–∏–≤–µ—Ä–≥–µ–Ω—Ç–Ω—ã–π', '–°—Ç—Ä–æ–±–∏–∑–º (–¥–∏–≤–µ—Ä–≥–µ–Ω—Ç–Ω—ã–π)'), 
        ('–°—Ç—Ä–æ–±–∏–∑–º_–∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ç–Ω—ã–π', '–°—Ç—Ä–æ–±–∏–∑–º (–∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ç–Ω—ã–π)'), ('–ù–∏—Å—Ç–∞–≥–º', '–ù–∏—Å—Ç–∞–≥–º'),
        ('–ì–∏–ø–µ—Ä–µ–º–∏—è_–≥–ª–∞–∑', '–ì–∏–ø–µ—Ä–µ–º–∏—è –≥–ª–∞–∑'), ('–û—Ç–µ—á–Ω–æ—Å—Ç—å_–≥–ª–∞–∑', '–û—Ç–µ—á–Ω–æ—Å—Ç—å –≥–ª–∞–∑'),
        ('–ì–∏–ø–µ—Ä–µ–º–∏—è_—É—à–µ–π', '–ì–∏–ø–µ—Ä–µ–º–∏—è —É—à–µ–π'), ('–ö–æ—Ä–∏—á–Ω–µ–≤—ã–µ_–≤—ã–¥–µ–ª–µ–Ω–∏—è_—É—à–µ–π_–æ–¥–Ω–æ', '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è —É—à–µ–π (–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ)'),
        ('–ö–æ—Ä–∏—á–Ω–µ–≤—ã–µ_–≤—ã–¥–µ–ª–µ–Ω–∏—è_—É—à–µ–π_–¥–≤—É', '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è —É—à–µ–π (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ)'), ('–û—Ç–µ—á–Ω–æ—Å—Ç—å_—É—à–µ–π_–æ–¥–Ω–æ', '–û—Ç–µ—á–Ω–æ—Å—Ç—å —É—à–µ–π (–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ)'),
        ('–û—Ç–µ—á–Ω–æ—Å—Ç—å_—É—à–µ–π_–¥–≤—É', '–û—Ç–µ—á–Ω–æ—Å—Ç—å —É—à–µ–π (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ)'),
    ],
    "–¢—Ä–∞–≤–º—ã –∏ –ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è": [
        ('–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ_–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ', '–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ (–∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ)'), ('–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ_–≤–µ–Ω–æ–∑–Ω–æ–µ', '–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ (–≤–µ–Ω–æ–∑–Ω–æ–µ)'),
        ('–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ_–∫–∞–ø–∏–ª–ª—è—Ä–Ω–æ–µ', '–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ (–∫–∞–ø–∏–ª–ª—è—Ä–Ω–æ–µ)'), ('–ü–µ—Ç–µ—Ö–∏–∏', '–ü–µ—Ç–µ—Ö–∏–∏'),
        ('–ì–µ–º–∞—Ç–æ–º–∞', '–ì–µ–º–∞—Ç–æ–º–∞'), ('–°–µ—Ä–æ–º–∞', '–°–µ—Ä–æ–º–∞'), ('–í—ã—Å–æ—Ç–Ω–∞—è_—Ç—Ä–∞–≤–º–∞', '–í—ã—Å–æ—Ç–Ω–∞—è —Ç—Ä–∞–≤–º–∞'),
        ('–ö—Ä–∞—à_—Å–∏–Ω–¥—Ä–æ–º', '–ö—Ä–∞—à-—Å–∏–Ω–¥—Ä–æ–º'), ('–≠–ª–µ–∫—Ç—Ä–æ—Ç—Ä–∞–≤–º–∞', '–≠–ª–µ–∫—Ç—Ä–æ—Ç—Ä–∞–≤–º–∞'),
        ('–û—Ç–∫—Ä—ã—Ç—ã–µ_—Ä–∞–Ω—ã', '–û—Ç–∫—Ä—ã—Ç—ã–µ —Ä–∞–Ω—ã'), ('–£—à–∏–±—ã_—Å–∏–Ω—è–∫–∏', '–û–±—à–∏—Ä–Ω—ã–µ —É—à–∏–±—ã'), 
        ('–ü—Ä–∏–∑–Ω–∞–∫–∏_–ø–µ—Ä–µ–ª–æ–º–æ–≤', '–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –ø–µ—Ä–µ–ª–æ–º'), ('–û–∂–æ–≥–∏', '–û–∂–æ–≥–∏'), ('–û–±–º–æ—Ä–æ–∂–µ–Ω–∏—è', '–û–±–º–æ—Ä–æ–∂–µ–Ω–∏—è'),
        ('–ö—É—Å–∞–ª_–∫–ª–µ—â', '–§–∞–∫—Ç: –∫—É—Å–∞–ª –∫–ª–µ—â'), ('–°–ª–µ–¥—ã_–∫—Ä–æ–≤–∏_–Ω–∞_–ø–æ–¥—Å—Ç–∏–ª–∫–µ', '–°–ª–µ–¥—ã –∫—Ä–æ–≤–∏ –Ω–∞ –ø–æ–¥—Å—Ç–∏–ª–∫–µ')
    ]
}


# --- 3. –ò–ù–¢–ï–†–§–ï–ô–°: –†–ê–ó–î–ï–õ–ï–ù–ò–ï –ù–ê –í–ö–õ–ê–î–ö–ò (–ü–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É –¢–∞–π—Å–æ–Ω–∞) ---

tab_anamnesis, tab_vitals, tab_symptoms = st.tabs([
    "1. –ê–Ω–∞–º–Ω–µ–∑ & –ò—Å—Ç–æ—Ä–∏—è", 
    "2. –ö–ª–∏–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ", 
    "3. –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å–∏–º–ø—Ç–æ–º—ã (–ñ–∞–ª–æ–±—ã)"
])

# --- 3.1. –ê–ù–ê–ú–ù–ï–ó & –ò–°–¢–û–†–ò–Ø ---
with tab_anamnesis:
    st.header('–û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ –ê–Ω–∞–º–Ω–µ–∑')
    
    # --- –î–µ–º–æ–≥—Ä–∞—Ñ–∏—è ---
    col_breed, col_age, col_gender = st.columns(3)
    with col_breed:
        breed_label = st.selectbox('–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ', list(demographic_keys['–ü–æ—Ä–æ–¥–∞'].values()), key='breed_label')
        breed_key = [k for k, v in demographic_keys['–ü–æ—Ä–æ–¥–∞'].items() if v == breed_label][0]
    with col_age:
        age_label_selected = st.selectbox('–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞', list(demographic_keys['–í–æ–∑—Ä–∞—Å—Ç'].values()), key='age_label')
        age_key = [k for k, v in demographic_keys['–í–æ–∑—Ä–∞—Å—Ç'].items() if v == age_label_selected][0]
    with col_gender:
        gender_label_selected = st.selectbox('–ü–æ–ª', list(demographic_keys['–ü–æ–ª'].values()), key='gender_label')
        gender_key = [k for k, v in demographic_keys['–ü–æ–ª'].items() if v == gender_label_selected][0]
    
    st.markdown('---')
    col_castr, col_own = st.columns(2)
    with col_castr:
        is_castrated = st.checkbox('–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ **–ö–∞—Å—Ç—Ä–∞—Ü–∏—è** (–¥–ª—è —Å–∞–º—Ü–æ–≤/—Å–∞–º–æ–∫)', key='is_castrated')
    with col_own:
        ownership_duration = st.selectbox('–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–ª–∞–¥–µ–Ω–∏—è', ['–ù–µ–¥–∞–≤–Ω–æ', '–ú–µ–Ω–µ–µ –≥–æ–¥–∞', '–ë–æ–ª–µ–µ –≥–æ–¥–∞'], key='ownership_duration')

    # --- –£—Å–ª–æ–≤–∏—è –∏ –∏—Å—Ç–æ—Ä–∏—è ---
    st.subheader('–£—Å–ª–æ–≤–∏—è —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∏ –∏—Å—Ç–æ—Ä–∏—è')
    col_housing, col_diet = st.columns(2)
    with col_housing:
        housing_options = ['–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ'] + list(demographic_keys['–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ'].values())
        housing_label = st.selectbox('–£—Å–ª–æ–≤–∏—è —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è', housing_options, key='housing_label')
    with col_diet:
        diet_options = ['–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ'] + list(demographic_keys['–î–∏–µ—Ç–∞'].values())
        diet_label = st.selectbox('–¢–∏–ø –∫–æ—Ä–º–ª–µ–Ω–∏—è', diet_options, key='diet_label')
        
    col_hist_1, col_hist_2, col_hist_3, col_hist_4 = st.columns(4)
    with col_hist_1:
        has_chronic = st.checkbox('–ï—Å—Ç—å —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è', key='has_chronic')
    with col_hist_2:
        has_surgery = st.checkbox('–ü–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏/–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è', key='has_surgery')
    with col_hist_3:
        has_antibio = st.checkbox('–ë—ã–ª –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–∞–Ω–∞–º–Ω–µ–∑', key='has_antibio')
    with col_hist_4:
        allergy_status = st.checkbox('–ï—Å—Ç—å –∞–ª–ª–µ—Ä–≥–∏—è', key='allergy_status')
        
    st.markdown('---')
    
    # --- –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ ---
    st.subheader('–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –∏ –í–∞–∫—Ü–∏–Ω–∞—Ü–∏—è')
    col_vax_status, col_deworm, col_ectopara, col_cohabiting = st.columns(4)
    with col_vax_status:
        vax_status = st.selectbox('–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –≤–∞–∫—Ü–∏–Ω–∞—Ü–∏—è?', ['–ù–µ—Ç', '–î–∞'], key='vax_status')
    with col_deworm:
        deworm_status = st.selectbox('–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –¥–µ–≥–µ–ª—å–º–∏–Ω—Ç–∏–∑–∞—Ü–∏—è?', ['–ù–µ—Ç', '–î–∞'], key='deworm_status')
    with col_ectopara:
        ectopara_status = st.selectbox('–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç –±–ª–æ—Ö/–∫–ª–µ—â–µ–π?', ['–ù–µ—Ç', '–î–∞'], key='ectopara_status')
    with col_cohabiting:
        cohabiting_status = st.selectbox('–ï—Å—Ç—å –ª–∏ –µ—â–µ –∂–∏–≤–æ—Ç–Ω—ã–µ?', ['–ù–µ—Ç', '–î–∞, –∑–¥–æ—Ä–æ–≤—ã', '–î–∞, —Å —Å–∏–º–ø—Ç–æ–º–∞–º–∏'], key='cohabiting_status')

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–µ–π –≤–∞–∫—Ü–∏–Ω
    vaccine_selection_virus_key = '–ù–µ—Ç_–≤–∏—Ä—É—Å–Ω–æ–π_–≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏'
    vaccine_selection_rabies_key = '–ù–µ—Ç_–±–µ—à–µ–Ω—Å—Ç–≤–∞'
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è NameError
    is_complex_rabies_dog = False 
    is_complex_rabies_cat = False
    
    if vax_status == '–î–∞':
        st.markdown('###### –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—É—é –≤–∞–∫—Ü–∏–Ω—É (—Ç–æ–ª—å–∫–æ –û–î–ù–£):')
        col_vax_v, col_vax_r = st.columns(2)
        
        if breed_key == '—Å–æ–±–∞–∫–∞':
            virus_options = list(VACCINES_DOGS_VIRUS.values())
            complex_options = list(DOG_COMPLEX_RABIES.values())
            all_virus_options = ['–ù–µ—Ç'] + virus_options + complex_options
            
            with col_vax_v:
                vax_virus_label = st.selectbox('–í–∏—Ä—É—Å–Ω–∞—è / –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –≤–∞–∫—Ü–∏–Ω–∞', options=all_virus_options, key='vax_virus_select')
                if vax_virus_label == '–ù–µ—Ç':
                       vaccine_selection_virus_key = '–ù–µ—Ç_–≤–∏—Ä—É—Å–Ω–æ–π_–≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏'
                else:
                    # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–µ–º {**A, **B} –≤–º–µ—Å—Ç–æ A | B –¥–ª—è Python 3.8
                    vaccine_selection_virus_key = [k for k, v in {**VACCINES_DOGS_VIRUS, **DOG_COMPLEX_RABIES}.items() if v == vax_virus_label][0]

            is_complex_rabies_dog = vax_virus_label in complex_options
            
            with col_vax_r:
                if is_complex_rabies_dog:
                    st.selectbox('–û—Ç –ë–µ—à–µ–Ω—Å—Ç–≤–∞ (–ú–æ–Ω–æ–≤–∞–∫—Ü–∏–Ω–∞)', options=[f"{vax_virus_label} (–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è)"], disabled=True, key='vax_rabies_select_disabled')
                    if vaccine_selection_virus_key == 'nobivac_rl':
                         vaccine_selection_rabies_key = 'nobivac_rl'
                    else:
                         vaccine_selection_rabies_key = 'rabies_included_in_complex' 
                else:
                    rabies_options = ['–ù–µ—Ç'] + list(VACCINES_DOGS_RABIES.values())
                    vax_rabies_label = st.selectbox('–û—Ç –ë–µ—à–µ–Ω—Å—Ç–≤–∞ (–ú–æ–Ω–æ–≤–∞–∫—Ü–∏–Ω–∞)', options=rabies_options, key='vax_rabies_select')
                    if vax_rabies_label == '–ù–µ—Ç':
                        vaccine_selection_rabies_key = '–ù–µ—Ç_–±–µ—à–µ–Ω—Å—Ç–≤–∞'
                    else:
                        vaccine_selection_rabies_key = [k for k, v in VACCINES_DOGS_RABIES.items() if v == vax_rabies_label][0]


        elif breed_key == '–∫–æ—à–∫–∞':
            virus_options = list(VACCINES_CATS_VIRUS.values())
            complex_options = list(CAT_COMPLEX_RABIES.values())
            all_virus_options = ['–ù–µ—Ç'] + virus_options + complex_options
            
            with col_vax_v:
                vax_virus_label = st.selectbox('–í–∏—Ä—É—Å–Ω–∞—è / –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –≤–∞–∫—Ü–∏–Ω–∞', options=all_virus_options, key='vax_virus_select_c')
                if vax_virus_label == '–ù–µ—Ç':
                       vaccine_selection_virus_key = '–ù–µ—Ç_–≤–∏—Ä—É—Å–Ω–æ–π_–≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏'
                else:
                    # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–µ–º {**A, **B} –≤–º–µ—Å—Ç–æ A | B –¥–ª—è Python 3.8
                    vaccine_selection_virus_key = [k for k, v in {**VACCINES_CATS_VIRUS, **CAT_COMPLEX_RABIES}.items() if v == vax_virus_label][0]

            is_complex_rabies_cat = vax_virus_label in complex_options
            
            with col_vax_r:
                if is_complex_rabies_cat:
                    st.selectbox('–û—Ç –ë–µ—à–µ–Ω—Å—Ç–≤–∞ (–ú–æ–Ω–æ–≤–∞–∫—Ü–∏–Ω–∞)', options=[f"{vax_virus_label} (–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è)"], disabled=True, key='vax_rabies_select_disabled_c')
                    vaccine_selection_rabies_key = 'rabies_included_in_complex'
                else:
                    rabies_options = ['–ù–µ—Ç'] + list(VACCINES_CATS_RABIES.values())
                    vax_rabies_label = st.selectbox('–û—Ç –ë–µ—à–µ–Ω—Å—Ç–≤–∞ (–ú–æ–Ω–æ–≤–∞–∫—Ü–∏–Ω–∞)', options=rabies_options, key='vax_rabies_select_c')
                    if vax_rabies_label == '–ù–µ—Ç':
                        vaccine_selection_rabies_key = '–ù–µ—Ç_–±–µ—à–µ–Ω—Å—Ç–≤–∞'
                    else:
                        vaccine_selection_rabies_key = [k for k, v in VACCINES_CATS_RABIES.items() if v == vax_rabies_label][0]


# --- 3.2. –ö–õ–ò–ù–ò–ß–ï–°–ö–û–ï –û–ë–°–õ–ï–î–û–í–ê–ù–ò–ï (VITALS) ---
with tab_vitals:
    st.header('–û–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ –û–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ')
    
    # --- –û–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ ---
    col_overall, col_mental, col_weight = st.columns(3)
    with col_overall:
        overall_status_label = st.selectbox('–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ', list(demographic_keys['–û–±—â–µ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ'].values()), key='overall_status')
        overall_status_key = [k for k, v in demographic_keys['–û–±—â–µ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ'].items() if v == overall_status_label][0]
    with col_mental:
        mental_status_label = st.selectbox('–ú–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å', list(demographic_keys['–ú–µ–Ω—Ç–∞–ª—å–Ω—ã–π_—Å—Ç–∞—Ç—É—Å'].values()), key='mental_status')
        mental_status_key = [k for k, v in demographic_keys['–ú–µ–Ω—Ç–∞–ª—å–Ω—ã–π_—Å—Ç–∞—Ç—É—Å'].items() if v == mental_status_label][0]
    with col_weight:
        weight_label = st.selectbox('–í–µ—Å –∏ –∫–æ–Ω–¥–∏—Ü–∏—è', list(demographic_keys['–í–µ—Å'].values()), key='weight_label_vitals')
        weight_key_vitals = [k for k, v in demographic_keys['–í–µ—Å'].items() if v == weight_label][0] 

    col_temp, col_kns, col_dehydr = st.columns(3)
    with col_temp:
        temp_label = st.selectbox('–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞', list(demographic_keys['–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞'].values()), key='temp_label_vitals')
        temp_key_vitals = [k for k, v in demographic_keys['–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞'].items() if v == temp_label][0]
    with col_kns:
        kns_status_label = st.selectbox('–ö–ù–°', list(demographic_keys['–ö–ù–°'].values()), key='kns_status')
        kns_status_key = [k for k, v in demographic_keys['–ö–ù–°'].items() if v == kns_status_label][0]
    with col_dehydr:
        dehydration_status_label = st.selectbox('–ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–µ–≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏', list(demographic_keys['–î–µ–≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è'].values()), key='dehydration_status')
        dehydration_status_key = [k for k, v in demographic_keys['–î–µ–≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è'].items() if v == dehydration_status_label][0]
        
    st.subheader('–°–µ—Ä–¥–µ—á–Ω–æ-–¥—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞')
    col_pulse, col_heart_ausc, col_resp_rate = st.columns(3)
    with col_pulse:
        pulse_status_label = st.selectbox('–ü—É–ª—å—Å (–ß–∞—Å—Ç–æ—Ç–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–æ)', list(demographic_keys['–ü—É–ª—å—Å'].values()), key='pulse_status')
        pulse_status_key = [k for k, v in demographic_keys['–ü—É–ª—å—Å'].items() if v == pulse_status_label][0]
    with col_heart_ausc:
        auscultation_heart_label = st.selectbox('–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è —Å–µ—Ä–¥—Ü–∞', list(demographic_keys['–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è_—Å–µ—Ä–¥—Ü–∞'].values()), key='auscultation_heart')
        auscultation_heart_key = [k for k, v in demographic_keys['–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è_—Å–µ—Ä–¥—Ü–∞'].items() if v == auscultation_heart_label][0]
    with col_resp_rate:
        resp_status_label = st.selectbox('–î—ã—Ö–∞–Ω–∏–µ (–ß–∞—Å—Ç–æ—Ç–∞/–•–∞—Ä–∞–∫—Ç–µ—Ä)', list(demographic_keys['–î—ã—Ö–∞–Ω–∏–µ_–ø–∞—Ç—Ç–µ—Ä–Ω'].values()), key='resp_status')
        resp_status_key = [k for k, v in demographic_keys['–î—ã—Ö–∞–Ω–∏–µ_–ø–∞—Ç—Ç–µ—Ä–Ω'].items() if v == resp_status_label][0]

    col_lung_ausc, col_resp_type, col_trachea_refl, col_tono = st.columns(4)
    with col_lung_ausc:
        auscultation_lung_label = st.selectbox('–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è –ª–µ–≥–∫–∏—Ö', list(demographic_keys['–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è_–ª–µ–≥–∫–∏—Ö'].values()), key='auscultation_lung')
        auscultation_lung_key = [k for k, v in demographic_keys['–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è_–ª–µ–≥–∫–∏—Ö'].items() if v == auscultation_lung_label][0]
    with col_resp_type:
        resp_type_label = st.selectbox('–¢–∏–ø –¥—ã—Ö–∞–Ω–∏—è', list(demographic_keys['–¢–∏–ø_–¥—ã—Ö–∞–Ω–∏—è'].values()), key='resp_type')
        resp_type_key = [k for k, v in demographic_keys['–¢–∏–ø_–¥—ã—Ö–∞–Ω–∏—è'].items() if v == resp_type_label][0]
    with col_trachea_refl:
        trachea_reflex = st.radio('–¢—Ä–∞—Ö–µ–∞–ª—å–Ω—ã–π —Ä–µ—Ñ–ª–µ–∫—Å', ['–î–∞', '–ù–µ—Ç'], key='trachea_reflex')
    with col_tono:
        tonometry_status_label = st.selectbox('–¢–æ–Ω–æ–º–µ—Ç—Ä–∏—è', list(demographic_keys['–¢–æ–Ω–æ–º–µ—Ç—Ä–∏—è'].values()), key='tonometry_status')
        tonometry_status_key = [k for k, v in demographic_keys['–¢–æ–Ω–æ–º–µ—Ç—Ä–∏—è'].items() if v == tonometry_status_label][0]


# --- 3.3. –ö–õ–ò–ù–ò–ß–ï–°–ö–ò–ï –°–ò–ú–ü–¢–û–ú–´ (–ñ–ê–õ–û–ë–´) ---
with tab_symptoms:
    st.header('–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å–∏–º–ø—Ç–æ–º—ã (–ñ–∞–ª–æ–±—ã –≤–ª–∞–¥–µ–ª—å—Ü–∞)')
    st.markdown('**–í—ã–±–µ—Ä–∏—Ç–µ –≤—Å–µ –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö.**')

    selected_symptoms = {}
    
    symptom_tab_list = st.tabs(list(symptom_groups.keys()))

    for tab, (group_name, symptoms_list) in zip(symptom_tab_list, symptom_groups.items()):
        with tab:
            st.markdown(f"**{group_name}**")
            num_cols = 4
            cols = st.columns(num_cols)
            
            for i, (symptom_key, display_label) in enumerate(symptoms_list):
                with cols[i % num_cols]:
                    selected_symptoms[symptom_key] = st.checkbox(display_label, key=f"symptom_{symptom_key}")


st.markdown('---')

# --- 4. –õ–û–ì–ò–ö–ê –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø (–°–±–æ—Ä –≤—Å–µ—Ö –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π) ---
if st.button('–†–ê–°–°–ß–ò–¢–ê–¢–¨ –ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–´–ô –î–ò–ê–ì–ù–û–ó', type="primary", use_container_width=True):
    
    with st.spinner('–°–±–æ—Ä –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞...'):
        
        # --- 4.1. –°–±–æ—Ä –í–°–ï–• –¥–µ—Ç–∞–ª–µ–π –¥–ª—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏ (150+ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤) ---
        final_input_dict = {}
        
        # 1. –î–µ–º–æ–≥—Ä–∞—Ñ–∏—è (OHE –∫–ª—é—á–∏)
        final_input_dict[f'–ü–æ—Ä–æ–¥–∞_{breed_key}'] = 1
        final_input_dict[f'–í–æ–∑—Ä–∞—Å—Ç_{age_key}'] = 1
        final_input_dict[f'–ü–æ–ª_{gender_key}'] = 1
        final_input_dict['–ö–∞—Å—Ç—Ä–∞—Ü–∏—è_–î–∞'] = 1 if is_castrated else 0
        
        # 2. –ê–Ω–∞–º–Ω–µ–∑ (OHE + –ë–∏–Ω–∞—Ä–Ω—ã–µ)
        final_input_dict['–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å_–≤–ª–∞–¥–µ–Ω–∏—è_–ë–æ–ª–µ–µ_–≥–æ–¥–∞'] = 1 if ownership_duration == '–ë–æ–ª–µ–µ –≥–æ–¥–∞' else 0 
        final_input_dict[f'–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ_{housing_label.split(" ")[0].lower()}'] = 1 
        final_input_dict[f'–î–∏–µ—Ç–∞_{diet_label.split(" ")[0].lower()}'] = 1 
        
        final_input_dict['–•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ_–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è_–î–∞'] = 1 if has_chronic else 0
        final_input_dict['–ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ_–æ–ø–µ—Ä–∞—Ü–∏–∏_–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è_–î–∞'] = 1 if has_surgery else 0
        final_input_dict['–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–∞–Ω–∞–º–Ω–µ–∑_–î–∞'] = 1 if has_antibio else 0
        final_input_dict['–ê–ª–ª–µ—Ä–≥–∏—è_–î–∞'] = 1 if allergy_status else 0
        
        final_input_dict['–î–µ–≥–µ–ª—å–º–∏–Ω—Ç–∏–∑–∞—Ü–∏—è_–î–∞'] = 1 if deworm_status == '–î–∞' else 0
        final_input_dict['–û–±—Ä–∞–±–æ—Ç–∫–∞_–æ—Ç_–±–ª–æ—Ö_–∫–ª–µ—â–µ–π_–î–∞'] = 1 if ectopara_status == '–î–∞' else 0
        final_input_dict['–°–æ–∂–∏—Ç–µ–ª–∏_—Å_—Å–∏–º–ø—Ç–æ–º–∞–º–∏_–î–∞'] = 1 if cohabiting_status == '–î–∞, —Å —Å–∏–º–ø—Ç–æ–º–∞–º–∏' else 0

        # –í–∞–∫—Ü–∏–Ω–∞—Ü–∏—è (OHE –∫–ª—é—á–∏)
        final_input_dict[f'–í–∏—Ä—É—Å–Ω–∞—è_–≤–∞–∫—Ü–∏–Ω–∞_{vaccine_selection_virus_key}'] = 1
        final_input_dict[f'–ë–µ—à–µ–Ω—Å—Ç–≤–æ_–≤–∞–∫—Ü–∏–Ω–∞_{vaccine_selection_rabies_key}'] = 1


        # 3. Vitals (OHE –∫–ª—é—á–∏)
        final_input_dict[f'–û–±—â–µ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ_{overall_status_key}'] = 1
        final_input_dict[f'–ú–µ–Ω—Ç–∞–ª—å–Ω—ã–π_—Å—Ç–∞—Ç—É—Å_{mental_status_key}'] = 1
        final_input_dict[f'–í–µ—Å_–∫–æ–Ω–¥–∏—Ü–∏—è_{weight_key_vitals}'] = 1
        final_input_dict[f'–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞_—Ç–µ–ª–∞_{temp_key_vitals}'] = 1
        final_input_dict[f'–ü—É–ª—å—Å_{pulse_status_key}'] = 1
        final_input_dict[f'–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è_—Å–µ—Ä–¥—Ü–∞_{auscultation_heart_key}'] = 1
        final_input_dict[f'–î—ã—Ö–∞–Ω–∏–µ_–ø–∞—Ç—Ç–µ—Ä–Ω_{resp_status_key}'] = 1
        final_input_dict[f'–ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è_–ª–µ–≥–∫–∏—Ö_{auscultation_lung_key}'] = 1
        final_input_dict[f'–¢–∏–ø_–¥—ã—Ö–∞–Ω–∏—è_{resp_type_key}'] = 1
        final_input_dict[f'–î–µ–≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è_{dehydration_status_key}'] = 1
        final_input_dict[f'–ö–ù–°_{kns_status_key}'] = 1
        final_input_dict[f'–¢–æ–Ω–æ–º–µ—Ç—Ä–∏—è_{tonometry_status_key}'] = 1
        final_input_dict['–¢—Ä–∞—Ö–µ–∞–ª—å–Ω—ã–π_—Ä–µ—Ñ–ª–µ–∫—Å_–î–∞'] = 1 if trachea_reflex == '–î–∞' else 0


        # 4. –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å–∏–º–ø—Ç–æ–º—ã (–ë–∏–Ω–∞—Ä–Ω—ã–µ –∫–ª—é—á–∏)
        for symptom_key, is_selected in selected_symptoms.items():
            final_input_dict[symptom_key] = 1 if is_selected else 0


        # --- 4.2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ (–†–ï–ê–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê 15) ---
        
        # 1. –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π DataFrame —Å–æ –≤—Å–µ–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –≤ –Ω—É–∂–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
        input_df_aligned = pd.DataFrame(0, index=[0], columns=TRAINING_FEATURES)
        
        # 2. –ó–∞–ø–æ–ª–Ω—è–µ–º DataFrame –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (1)
        for feature, value in final_input_dict.items():
            if feature in TRAINING_FEATURES:
                input_df_aligned.loc[0, feature] = value
        
        # 3. –ü—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (StandardScaler)
        processed_input = preprocessor.transform(input_df_aligned)
        
        # 4. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        predictions_proba = model.predict(processed_input)
        predictions = predictions_proba[0]
        
        # –ë–µ—Ä–µ–º –¢–û–ü-2 –¥–∏–∞–≥–Ω–æ–∑–∞
        top_2_indices = predictions.argsort()[-2:][::-1]
        top_2_probabilities = predictions[top_2_indices]
        top_2_diagnoses = label_encoder.inverse_transform(top_2_indices)

    st.markdown('## 4. –†–µ–∑—É–ª—å—Ç–∞—Ç –ê–Ω–∞–ª–∏–∑–∞ (–ü—Ä–æ—Ç–æ–∫–æ–ª)')
    
    st.markdown('### üí° –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∏–∞–≥–Ω–æ–∑—ã')
    
    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏–∞–≥–Ω–æ–∑–∞: –†—É—Å—Å–∫–∏–π + (–õ–∞—Ç—ã–Ω—å/–ö–ª—é—á)
    def format_diagnosis(key):
        return DIAGNOSIS_TRANSLATIONS.get(key, key.replace('_', ' ').capitalize() + f" (Key: {key})")
    
    # –ü–µ—Ä–≤—ã–π –¥–∏–∞–≥–Ω–æ–∑
    diagnosis_1_key = top_2_diagnoses[0]
    diagnosis_1_display = format_diagnosis(diagnosis_1_key)
    prob_1 = top_2_probabilities[0]
    st.success(f"**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –î–∏–∞–≥–Ω–æ–∑ 1:** {diagnosis_1_display} ‚Äî **{prob_1*100:.1f}%**")
    
    # –í—Ç–æ—Ä–æ–π –¥–∏–∞–≥–Ω–æ–∑
    if len(top_2_diagnoses) > 1:
        diagnosis_2_key = top_2_diagnoses[1]
        diagnosis_2_display = format_diagnosis(diagnosis_2_key)
        prob_2 = top_2_probabilities[1]
        st.info(f"**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –î–∏–∞–≥–Ω–æ–∑ 2 (–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π):** {diagnosis_2_display} ‚Äî {prob_2*100:.1f}%")

    st.markdown('---')
    
    # --- –í–´–í–û–î –ü–†–û–¢–û–ö–û–õ–ê ---
    
    # –õ–æ–≥–∏–∫–∞ —Å–±–æ—Ä–∞ –≤–∞–∫—Ü–∏–Ω –¥–ª—è –≤—ã–≤–æ–¥–∞
    final_vax_output = []
    if vax_status == '–î–∞':
        if vaccine_selection_virus_key != '–ù–µ—Ç_–≤–∏—Ä—É—Å–Ω–æ–π_–≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏':
            final_vax_output.append(f"–í–∏—Ä—É—Å–Ω–∞—è/–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è: {vax_virus_label}")
            
            # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ is_complex_rabies_dog/cat
            if is_complex_rabies_dog or is_complex_rabies_cat:
                final_vax_output.append(f"–ë–µ—à–µ–Ω—Å—Ç–≤–æ: {vax_virus_label} (–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è)")
            elif vaccine_selection_rabies_key != '–ù–µ—Ç_–±–µ—à–µ–Ω—Å—Ç–≤–∞':
                 vax_rabies_label = [v for k, v in VACCINES_DOGS_RABIES.items() if k == vaccine_selection_rabies_key][0] if breed_key == '—Å–æ–±–∞–∫–∞' else [v for k, v in VACCINES_CATS_RABIES.items() if k == vaccine_selection_rabies_key][0]
                 final_vax_output.append(f"–ë–µ—à–µ–Ω—Å—Ç–≤–æ: {vax_rabies_label}")

    final_vax_display = '; '.join(final_vax_output) if final_vax_output else '–í–∞–∫—Ü–∏–Ω–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞'
    
    # –°–±–æ—Ä –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞ –≤ –ü—Ä–æ—Ç–æ–∫–æ–ª
    active_symptoms_list = [f"‚úÖ {label}" for key, group in symptom_groups.items() for s_key, label in group if selected_symptoms.get(s_key)]
    
    st.markdown('### üìù –ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è')
    
    st.markdown("#### –ê–Ω–∞–º–Ω–µ–∑ –∏ –ò—Å—Ç–æ—Ä–∏—è")
    col_an_1, col_an_2, col_an_3, col_an_4 = st.columns(4)
    col_an_1.markdown(f"**–í–∏–¥/–í–æ–∑—Ä–∞—Å—Ç:** {breed_label} / {age_label_selected}")
    col_an_2.markdown(f"**–ü–æ–ª:** {gender_label_selected} ({'–ö–∞—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω/–Ω–∞' if is_castrated else '–ù–µ –∫–∞—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω/–Ω–∞'})")
    col_an_3.markdown(f"**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ/–î–∏–µ—Ç–∞:** {housing_label} / {diet_label}")
    col_an_4.markdown(f"**–•—Ä–æ–Ω–∏—á./–ê–ª–ª–µ—Ä–≥–∏—è:** {'–î–∞' if has_chronic else '–ù–µ—Ç'} / {'–î–∞' if allergy_status else '–ù–µ—Ç'}")
    st.markdown(f"**–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:** –î–µ–≥–µ–ª—å–º: {deworm_status}; –≠–∫—Ç–æ: {ectopara_status}; –°–æ–∂–∏—Ç–µ–ª–∏: {cohabiting_status}")
    st.markdown(f"**–í–∞–∫—Ü–∏–Ω–∞—Ü–∏—è:** {final_vax_display}")
    
    st.markdown("#### –ö–ª–∏–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ")
    col_v_1, col_v_2, col_v_3 = st.columns(3)
    col_v_1.markdown(f"**–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** {overall_status_label} ({mental_status_label})")
    col_v_2.markdown(f"**–í–µ—Å/–ö–æ–Ω–¥–∏—Ü–∏—è:** {weight_label}")
    col_v_3.markdown(f"**–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:** {temp_label}")
    
    col_v_4, col_v_5, col_v_6 = st.columns(3)
    col_v_4.markdown(f"**–ü—É–ª—å—Å:** {pulse_status_key} / **–°–µ—Ä–¥—Ü–µ (–ê—É—Å–∫.):** {auscultation_heart_key}")
    col_v_5.markdown(f"**–î—ã—Ö–∞–Ω–∏–µ (–ß–∞—Å—Ç–æ—Ç–∞/–¢–∏–ø):** {resp_status_key} / {resp_type_key}")
    col_v_6.markdown(f"**–õ–µ–≥–∫–∏–µ (–ê—É—Å–∫.):** {auscultation_lung_key} / **–¢—Ä–∞—Ö. –†–µ—Ñ.:** {trachea_reflex}")
    
    col_v_7, col_v_8, col_v_9 = st.columns(3)
    col_v_7.markdown(f"**–î–µ–≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è:** {dehydration_status_key}")
    col_v_8.markdown(f"**–ö–ù–°:** {kns_status_key}")
    col_v_9.markdown(f"**–¢–æ–Ω–æ–º–µ—Ç—Ä–∏—è:** {tonometry_status_key}")

    st.markdown("#### –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å–∏–º–ø—Ç–æ–º—ã (–í—ã–±—Ä–∞–Ω–Ω—ã–µ)")
    
    if active_symptoms_list:
        cols_symp = st.columns(4)
        for i, symp in enumerate(active_symptoms_list):
            cols_symp[i % 4].markdown(symp)
    else:
        st.markdown("*–°–∏–º–ø—Ç–æ–º—ã –Ω–µ –≤—ã–±—Ä–∞–Ω—ã.*")
    
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è PDF
    report_payload = {
        'diag1': diagnosis_1_display,
        'prob1': f"{prob_1*100:.1f}%",
        'diag2': diagnosis_2_display if len(top_2_diagnoses) > 1 else "–ù–µ—Ç",
        'breed': breed_label,
        'age': age_label_selected,
        'vax': final_vax_display,
        'preventive': f"–î–µ–≥–µ–ª—å–º: {deworm_status}; –≠–∫—Ç–æ: {ectopara_status}",
        'status': f"{overall_status_label} ({mental_status_label})",
        'weight': weight_label,
        'temp': temp_label,
        'heart': auscultation_heart_key,
        'pulse': pulse_status_key,
        'resp': resp_status_key,
        'symptoms': [s.replace("‚úÖ ", "") for s in active_symptoms_list]
    }

    # –ö–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
    pdf_bytes = export_to_pdf(report_payload)
    st.download_button(
        label="üìÑ –°–∫–∞—á–∞—Ç—å PDF –ø—Ä–æ—Ç–æ–∫–æ–ª",
        data=pdf_bytes,
        file_name=f"VetAI_{breed_label}.pdf",
        mime="application/pdf",
        use_container_width=True
    )

    st.markdown("---")
    st.caption(f"**–í–µ—Ä—Å–∏—è:** v0.4.1 (Alpha). **–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–¥–µ–ª–∏ v{MODEL_VERSION}.** –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –¥–∏–∞–≥–Ω–æ–∑–∞.")